SUM=0;
for p=.01:.01:.5

N=10000;
T=zeros(1,N);
K=zeros(1,N);
K(1)=0; T(1)=1;
%K(2)=1; %wrong
%T(2)=min(T(1)+T(1),1+(1-(1-p)^2)*K(2));


for n=2:N
i=1:n-1;
K(n)=1+min((1-(1-p).^i).*(K(i)+T(n-i)) + ((1-p).^i).*(1-(1-p).^(n-i)).*K(n-i))/(1-(1-p)^n);
T(n)=min([T(i)+T(n-i),1+(1-(1-p)^n)*K(n)]);
end


SUM=SUM+T(end);
end
SUM
%K(n)=min((1-(1-p).^1).*(K(1)+T(2)) + ((1-p)^1)*(1-(1-p)^2)*K(2) , (1-(1-p)^2)*(K(2)+T(1)) + ((1-p)^2)*K(1))/(1-(1-p)^n);
